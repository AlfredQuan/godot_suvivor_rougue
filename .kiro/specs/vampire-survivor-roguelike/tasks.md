# 实现计划

- [x] 1. 建立项目结构和核心配置系统





  - 创建Godot项目基础目录结构（data/configs/, scripts/, scenes/, sprites/等）
  - 实现ConfigManager单例，支持JSON配置文件加载
  - 创建基础的Resource类（CharacterConfig, WeaponConfig, EnemyConfig, EffectConfig）
  - 编写配置文件加载和验证的单元测试
  - _需求: 7.1, 7.2, 7.3_

- [-] 2. 实现核心组件系统


  - [x] 2.1 创建HealthComponent组件







    - 编写HealthComponent脚本，包含生命值管理和伤害处理
    - 实现生命值变化信号和死亡检测
    - 创建HealthComponent的单元测试
    - _需求: 1.4, 4.3_

  - [x] 2.2 创建StatsComponent组件








    - 实现StatsComponent，支持基础属性和修改器系统
    - 编写属性计算逻辑，支持加法和乘法修改器
    - 实现属性变化信号系统
    - 创建属性计算准确性测试
    - _需求: 2.2, 5.2, 6.2_

  - [ ] 2.3 创建AIComponent组件
    - 实现基础AI组件，支持寻路和目标追踪
    - 编写不同AI行为类型（直线追击、环绕、远程攻击等）
    - 实现AI状态机系统
    - 创建AI行为测试场景
    - _需求: 4.2, 4.4_

- [ ] 3. 实现角色系统
  - [ ] 3.1 创建Player角色控制器
    - 编写Player脚本，集成HealthComponent和StatsComponent
    - 实现8方向移动控制和输入处理
    - 添加角色配置初始化逻辑
    - 创建角色移动和配置加载测试
    - _需求: 1.1, 1.2, 2.1, 2.2_

  - [ ] 3.2 实现角色升级系统
    - 编写经验值获取和等级计算逻辑
    - 实现升级时的属性提升应用
    - 创建升级事件信号系统
    - 编写升级系统的单元测试
    - _需求: 2.2, 5.1_

  - [ ] 3.3 创建角色选择界面
    - 设计角色选择UI场景
    - 实现角色配置展示和选择逻辑
    - 添加角色预览和属性显示
    - 创建角色选择流程测试
    - _需求: 2.3_

- [ ] 4. 实现武器系统
  - [ ] 4.1 创建基础武器框架
    - 编写Weapon基类，支持配置初始化和属性管理
    - 实现武器计时器和攻击逻辑
    - 创建武器工厂模式用于动态创建武器
    - 编写武器创建和配置测试
    - _需求: 3.1, 3.4_

  - [ ] 4.2 实现投射物系统
    - 创建Projectile基类和不同类型的投射物
    - 实现投射物移动、碰撞检测和伤害计算
    - 添加投射物对象池优化性能
    - 编写投射物行为和碰撞测试
    - _需求: 1.3, 3.1_

  - [ ] 4.3 实现武器升级和进化系统
    - 编写武器升级逻辑，支持属性提升和新效果
    - 实现武器进化条件检查和转换
    - 创建武器升级选项生成系统
    - 编写武器升级和进化的集成测试
    - _需求: 3.2, 3.3_

  - [ ] 4.4 创建WeaponSystem管理器
    - 实现WeaponSystem，管理多个武器的协调工作
    - 编写自动瞄准和目标选择逻辑
    - 实现武器槽位管理和武器切换
    - 创建武器系统集成测试
    - _需求: 1.3, 3.1_

- [ ] 5. 实现敌人系统
  - [ ] 5.1 创建Enemy基类
    - 编写Enemy脚本，集成HealthComponent和AIComponent
    - 实现敌人配置初始化和属性设置
    - 添加敌人死亡处理和奖励掉落
    - 创建敌人基础行为测试
    - _需求: 4.1, 4.3_

  - [ ] 5.2 实现EnemySpawner生成系统
    - 编写敌人生成器，支持波次生成和难度调节
    - 实现基于时间的难度曲线系统
    - 添加敌人数量限制和性能优化
    - 创建敌人生成和难度测试
    - _需求: 4.2_

  - [ ] 5.3 创建敌人AI行为
    - 实现不同类型敌人的AI脚本
    - 编写群体行为和特殊攻击模式
    - 添加敌人状态管理（巡逻、追击、攻击等）
    - 创建AI行为复杂度测试
    - _需求: 4.4_

- [ ] 6. 实现效果卡片系统
  - [ ] 6.1 创建EffectCard资源系统
    - 编写EffectCard Resource类和配置加载
    - 实现效果稀有度和概率计算
    - 创建效果前置条件和互斥关系检查
    - 编写效果配置验证测试
    - _需求: 5.5, 5.7, 5.8_

  - [ ] 6.2 实现EffectSystem管理器
    - 编写EffectSystem，管理激活效果和效果叠加
    - 实现随机效果选择和权重计算
    - 添加效果应用和移除逻辑
    - 创建效果系统核心功能测试
    - _需求: 5.1, 5.2, 5.3_

  - [ ] 6.3 创建效果处理器
    - 实现EffectProcessor，处理不同类型效果的应用
    - 编写属性修改器、武器增强、特殊能力等效果类型
    - 添加效果脚本扩展支持
    - 创建各种效果类型的单元测试
    - _需求: 5.2, 5.6_

  - [ ] 6.4 创建升级选择UI
    - 设计升级选择界面，展示3-4个随机效果选项
    - 实现效果卡片展示和选择交互
    - 添加效果描述和预览功能
    - 创建升级UI交互测试
    - _需求: 5.1, 5.4_

- [ ] 7. 实现局外成长系统
  - [ ] 7.1 创建永久升级系统
    - 编写永久升级配置和数据结构
    - 实现升级购买逻辑和货币消费
    - 添加永久升级效果应用到游戏中
    - 创建永久升级计算测试
    - _需求: 6.2, 6.3_

  - [ ] 7.2 实现游戏结算系统
    - 编写游戏结束检测和结算逻辑
    - 实现基于表现的奖励计算（时间、击杀、等级等）
    - 添加结算界面和统计展示
    - 创建结算奖励计算测试
    - _需求: 6.1_

  - [ ] 7.3 创建升级商店界面
    - 设计永久升级购买界面
    - 实现升级树展示和购买交互
    - 添加升级预览和确认功能
    - 创建升级商店UI测试
    - _需求: 6.2, 6.4_

- [ ] 8. 实现存档系统
  - [ ] 8.1 创建SaveManager
    - 编写SaveManager单例，处理数据序列化和反序列化
    - 实现自动存档和手动存档功能
    - 添加存档文件验证和错误恢复
    - 创建存档系统可靠性测试
    - _需求: 8.1, 8.3_

  - [ ] 8.2 实现进度数据管理
    - 编写玩家进度数据结构和管理逻辑
    - 实现进度加载和应用到游戏系统
    - 添加进度重置和备份功能
    - 创建进度数据完整性测试
    - _需求: 8.2, 8.4_

- [ ] 9. 实现游戏场景和UI系统
  - [ ] 9.1 创建主游戏场景
    - 设计GameScene场景结构，集成所有游戏系统
    - 实现游戏循环和状态管理
    - 添加暂停、继续、退出功能
    - 创建游戏场景集成测试
    - _需求: 1.1, 1.4_

  - [ ] 9.2 实现游戏UI系统
    - 创建游戏内UI（生命值、经验条、武器信息等）
    - 实现UI数据绑定和实时更新
    - 添加UI动画和视觉反馈
    - 创建UI响应性测试
    - _需求: 1.1, 2.3_

  - [ ] 9.3 创建主菜单系统
    - 设计主菜单场景和导航逻辑
    - 实现设置界面和选项保存
    - 添加游戏介绍和教程入口
    - 创建菜单系统导航测试
    - _需求: 6.2, 8.2_

- [ ] 10. 性能优化和最终集成
  - [ ] 10.1 实现对象池化系统
    - 创建通用对象池管理器
    - 为敌人、投射物、效果粒子实现对象池
    - 优化内存分配和垃圾回收
    - 创建性能基准测试
    - _需求: 4.2, 3.1_

  - [ ] 10.2 实现配置热重载
    - 添加开发模式下的配置文件监控
    - 实现配置变更的实时应用
    - 创建热重载错误处理机制
    - 编写热重载功能测试
    - _需求: 7.4_

  - [ ] 10.3 最终系统集成和测试
    - 集成所有系统，确保正确的依赖关系
    - 进行完整游戏流程测试
    - 优化游戏平衡性和用户体验
    - 创建端到端自动化测试
    - _需求: 1.1, 1.2, 1.3, 1.4_