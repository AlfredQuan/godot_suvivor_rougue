# 需求文档

## 介绍

本项目旨在使用Godot引擎开发一款类似于《吸血鬼幸存者》的肉鸽幸存者游戏。游戏将具有可扩展的角色、武器、敌人系统，随机效果机制，以及局外成长功能。游戏采用模块化设计，常量单独存储，便于后续内容扩展和平衡调整。

## 需求

### 需求 1 - 游戏核心循环

**用户故事：** 作为玩家，我希望能够控制角色在游戏世界中移动并自动攻击敌人，以便体验核心的幸存者游戏玩法。

#### 验收标准

1. 当玩家启动游戏时，系统应当生成一个可控制的角色在游戏场景中
2. 当玩家使用输入设备时，角色应当能够在8个方向自由移动
3. 当敌人进入攻击范围时，角色应当自动向最近的敌人发射武器
4. 当角色生命值降为0时，游戏应当结束并显示结算界面

### 需求 2 - 可扩展角色系统

**用户故事：** 作为开发者，我希望能够轻松添加新角色，以便丰富游戏内容和玩家选择。

#### 验收标准

1. 当创建新角色时，系统应当支持通过配置文件定义角色属性（生命值、移动速度、初始武器等）
2. 当角色升级时，系统应当根据角色配置应用相应的属性加成
3. 当选择角色时，系统应当显示角色的独特技能和属性描述
4. 如果角色配置文件格式正确，系统应当能够动态加载新角色而无需修改核心代码

### 需求 3 - 可扩展武器系统

**用户故事：** 作为开发者，我希望能够创建多样化的武器类型，以便提供丰富的战斗体验。

#### 验收标准

1. 当创建武器时，系统应当支持通过配置定义武器属性（伤害、攻击速度、射程、弹道类型等）
2. 当武器升级时，系统应当根据配置应用升级效果（伤害提升、额外效果等）
3. 当武器达到最高等级时，系统应当提供进化选项将武器转换为更强大的版本
4. 如果武器行为需要特殊逻辑，系统应当支持通过脚本扩展武器功能

### 需求 4 - 可扩展敌人系统

**用户故事：** 作为开发者，我希望能够设计各种类型的敌人，以便创造多样化的挑战。

#### 验收标准

1. 当创建敌人时，系统应当支持通过配置定义敌人属性（生命值、移动速度、攻击力、AI行为类型）
2. 当游戏进行时，系统应当根据时间和难度曲线生成相应强度的敌人
3. 当敌人被击败时，系统应当根据配置掉落经验值和可能的道具
4. 如果敌人需要特殊行为，系统应当支持通过AI脚本定义复杂的行为模式

### 需求 5 - 可扩展随机效果系统

**用户故事：** 作为玩家，我希望在游戏中获得随机的能力提升，以便每次游戏都有不同的体验。

**用户故事：** 作为开发者，我希望能够轻松添加新的效果卡片，以便持续丰富游戏内容。

#### 验收标准

1. 当角色升级时，系统应当提供3-4个随机选择的能力提升选项
2. 当选择能力提升时，系统应当立即应用效果到角色或武器上
3. 当能力提升被选择多次时，系统应当根据配置叠加或进化效果
4. 如果某些能力提升有前置条件，系统应当只在满足条件时提供这些选项
5. 当创建新效果卡片时，系统应当支持通过配置文件定义效果属性（名称、描述、图标、效果类型、数值等）
6. 当效果需要复杂逻辑时，系统应当支持通过脚本扩展效果功能而无需修改核心代码
7. 如果效果卡片有稀有度分级，系统应当根据稀有度调整出现概率
8. 当效果卡片有互斥关系时，系统应当确保不会同时提供冲突的选项

### 需求 6 - 局外成长系统

**用户故事：** 作为玩家，我希望能够使用游戏中获得的资源来永久提升角色能力，以便在后续游戏中有更好的表现。

#### 验收标准

1. 当游戏结束时，系统应当根据表现给予玩家永久货币（如金币、经验等）
2. 当玩家在主菜单时，系统应当提供升级界面用于消费永久货币提升基础属性
3. 当购买永久升级时，系统应当在所有后续游戏中应用这些提升
4. 如果玩家重置进度，系统应当提供选项清除所有永久升级并返还部分资源

### 需求 7 - 常量管理系统

**用户故事：** 作为开发者，我希望所有游戏数值都集中管理，以便于调试和平衡性调整。

#### 验收标准

1. 当修改游戏数值时，系统应当支持通过外部配置文件修改而无需重新编译
2. 当加载游戏时，系统应当从配置文件中读取所有常量值
3. 当配置文件格式错误时，系统应当使用默认值并记录错误信息
4. 如果在开发模式下，系统应当支持热重载配置文件以便实时调试

### 需求 8 - 游戏进度和存档

**用户故事：** 作为玩家，我希望我的游戏进度能够被保存，以便下次游戏时能够继续之前的成长。

#### 验收标准

1. 当游戏结束时，系统应当自动保存玩家的永久升级进度
2. 当启动游戏时，系统应当加载玩家之前的进度数据
3. 当存档文件损坏时，系统应当创建新的存档并通知玩家
4. 如果玩家选择重置进度，系统应当清除存档并重新开始